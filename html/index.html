<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Chat</title>

  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

  <link href="static/styles/style.css" rel="stylesheet" type="text/css">
  <link href="static/styles/dark.css" rel="stylesheet" type="text/css">
</head>

<body>
  <div id="login-container">
    <div class="chat-form login-form" id="login-form">
      <h2>Login</h2>
      <input class="form-control login-item" id="username" placeholder="Username" required>
      <input class='form-control login-item' id="password" type="password" placeholder="Password" class="form-control" required>
      <button class='form-control login-item' type="submit" id="login">Sign In</button>
    </div>
  </div>

  <div class="chat" style="display:none;">
    <div id="chat-box" class="chat-box">
      <div id="offline"><span class="big">Server is offline.</span><br />Sorry for that.</div>
      <ul id="msgs" class="msgs"></ul>
      <ul id="typing" class="msgs"></ul>
    </div>
    <div class="chat-form">
      <ul id="emic" style="display:none;"></ul>
      <button id="emic_btn">
        <img src="static/emic/white-smiling-face.png" width="20px" height="20px" title="White Smiling Face">
      </button>
      <textarea id="form_input" class="form-control" data-user-id="2" placeholder="Type something ..."
        rows="1"></textarea>
      <button id="send">Send</button>
      <ul id="users"></ul>
    </div>
  </div>

  <button id="hideyhidey" type="button" onclick="makecloak('https://classroom.google.com')"
    style="position: absolute; top: 0; left: 0; z-index: 9999; background-color: #2F2C2C; color: #F8FFFF">Hidey Hidey
    :)</button>
  <script type="text/javascript" src="socket.io/socket.io.js"></script>
  <script type="text/javascript" src="static/scripts/emic.js"></script>
  <script type="text/javascript" src="static/scripts/chat.js"></script>
  <script type="text/javascript">
    // optionally set own server where the client connects to
    const socket = io(location.protocol + '//' + location.host, {path: location.pathname.replace(/\/$/, '') + '/socket.io/'})

    Emic.init();
    Chat.init(socket);

    function makecloak(replaceUrl) {
      if (window.top.location.href !== 'about:blank') {
        var url = window.location.href;
        const win = window.open();
        if (!win || win.closed || typeof win.closed == 'undefined') {
          return;
        }
        win.document.body.style.margin = '0';
        win.document.body.style.height = '100vh';
        var iframe = win.document.createElement('iframe');
        iframe.style.border = 'none';
        iframe.style.width = '100%';
        iframe.style.height = '100%';
        iframe.style.margin = '0';
        iframe.referrerpolicy = 'no-referrer';
        iframe.allow = 'fullscreen';
        iframe.src = url.toString();
        win.document.body.appendChild(iframe);
        window.location.replace(replaceUrl);
      }
    }
    if (window.top.location.href === 'about:blank')
      document.getElementById("hideyhidey").hidden = true;
  </script>
</body>

</html>
